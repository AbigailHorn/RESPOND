---
title: "EAC meeting - Survey data cleaning report"
author: "Weijia Hu"
date: "`r Sys.time()`"
output:
  html_document:
    toc: true
    toc_float: true
    df_print: paged
    code_folding: hide
  pdf_document: default
---

```{r setup, include=FALSE}
require("RPostgreSQL") # for PostgreSQL
library(zoo) # for date conversion
library(expss) # for labels
library(DBI) # for Database connectivity
library(summarytools) # for summarizing variables
library(tidyverse)
library(plyr)
library(dplyr)
library(knitr) # for creating tables
library(questionr)

# set working directory
#setwd 
("~/Google Drive File Stream/My Drive/Projects/RESPOND/CORE D/InitalDataCleaning")

```

```{css, echo = FALSE}
caption {
      color: Black;
      font-weight: bold;
      font-size: 1.5em;
      text-align: center
    }
```

```{r input survey data}
load("VSurvAll20210513.Rda")
d <- vsurvall
```

```{r first look - survey data}
new.d <- data.frame(matrix(ncol=0, nrow=nrow(d)))
new.d.1 <- data.frame(matrix(ncol=0, nrow=nrow(d)))
```

# LOCATION NAME
- Name of Registry delivery location
```{r location name }
  locationname <- as.factor(d[,"locationname"])
  
  new.d <- data.frame(new.d, locationname)
  new.d <- apply_labels(new.d, locationname = "Recruitment Location")
  
  #To get the number of each registry
  locationname_count<-count(new.d$locationname)
  colnames(locationname_count)<- c("Location", "Total")
  #To get freq of each registry
  locationname_freq1<-table(new.d$locationname)
  locationname_freq<-as.data.frame(round(prop.table(locationname_freq1),3))
  colnames(locationname_freq)<- c("Location", "Freq")
  #Merge them by "Location"
  result<-merge(locationname_count,locationname_freq,by="Location", sort=F)
  #Create a NICE table
  kable(result, format = "simple", align = 'l', caption = "Overview of Registry delivery location")
```

# B1 {.tabset}

- B1Aa: Father: Has this person had prostate cancer?
- B1Ba: Any Brother: Has this person had prostate cancer?
- B1Ca: Any Son: Has this person had prostate cancer?
- B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?
- B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?

## All data
```{r Family History}
# B1Aa: Father: Has this person had prostate cancer?
  b1aa <- as.factor(d[,"b1aa"])
# Make "*" to NA
  b1aa[which(b1aa=="*")]<-"NA"
  levels(b1aa) <- list(No="1",
                     Yes="2",
                     Dont_know="88")
  b1aa <- ordered(b1aa, c("No","Yes","Dont_know"))
  
  new.d <- data.frame(new.d, b1aa)
  new.d <- apply_labels(new.d, b1aa = "Father")
  temp.d <- data.frame (new.d, b1aa)  
  
  result<-questionr::freq(temp.d$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  b1ba <- as.factor(d[,"b1ba"])
  # Make "*" to NA
  b1ba[which(b1ba=="*")]<-"NA"
  levels(b1ba) <- list(No="1",
                     Yes="2",
                     Dont_know="88")
  b1ba <- ordered(b1ba, c("No","Yes","Dont_know"))
  
  new.d <- data.frame(new.d, b1ba)
  new.d <- apply_labels(new.d, b1ba = "Any Brother")
  temp.d <- data.frame (new.d, b1ba) 
  
  result<-questionr::freq(temp.d$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  b1ca <- as.factor(d[,"b1ca"])
  # Make "*" to NA
  b1ca[which(b1ca=="*")]<-"NA"
  levels(b1ca) <- list(No="1",
                     Yes="2",
                     Dont_know="88")
  b1ca <- ordered(b1ca, c( "No","Yes","Dont_know"))
  
  new.d <- data.frame(new.d, b1ca)
  new.d <- apply_labels(new.d, b1ca = "Any Son")
  temp.d <- data.frame (new.d, b1ca)
  
  result<-questionr::freq(temp.d$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer?")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?
  b1da <- as.factor(d[,"b1da"])
  # Make "*" to NA
  b1da[which(b1da=="*")]<-"NA"
  levels(b1da) <- list(No="1",
                     Yes="2",
                     Dont_know="88")
  b1da <- ordered(b1da, c( "No","Yes","Dont_know"))
  
  new.d <- data.frame(new.d, b1da)
  new.d <- apply_labels(new.d, b1da = "Maternal Grandfather (Mom’s side)")
  temp.d <- data.frame (new.d, b1da)
  
  result<-questionr::freq(temp.d$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  b1ea <- as.factor(d[,"b1ea"])
  # Make "*" to NA
  b1ea[which(b1ea=="*")]<-"NA"
  levels(b1ea) <- list(No="1",
                     Yes="2",
                     Dont_know="88")
  b1ea <- ordered(b1ea, c("No","Yes","Dont_know"))
  
  new.d <- data.frame(new.d, b1ea)
  new.d <- apply_labels(new.d, b1ea = "Paternal Grandfather (Dad’s side)")
  temp.d <- data.frame (new.d, b1ea)
  
  result<-questionr::freq(temp.d$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
```

## Detroit
```{r B11, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## Georgia
```{r B12, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## Greater Bay
```{r B13, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## Greater CA
```{r B14, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## LA
```{r B15, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## Louisiana
```{r B16, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## New Jersey
```{r B17, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## Texas
```{r B18, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

## Virtual
```{r B19, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
# B1Aa: Father: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Aa: Father: Has this person had prostate cancer?")
# B1Ba: Any Brother: Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ba: Any Brother: Has this person had prostate cancer?")
# B1Ca: Any Son: Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ca: Any Son: Has this person had prostate cancer? ")
# B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer? 
  result<-questionr::freq(temp.dd$b1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Da: Maternal Grandfather (Mom’s side): Has this person had prostate cancer?")
# B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?
  result<-questionr::freq(temp.dd$b1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "B1Ea: Paternal Grandfather (Dad’s side): Has this person had prostate cancer?")
rm(temp.dd) 
```

# B1 - Family History {.tabset}
- Based on B1
- FH_Sum=0
  + if B1Aa=2 then FH_Sum+1; father
  + if B1Ba=2 then FH_Sum+1; any brother
  + if B1Ca=2 then FH_Sum+1; any son
  + if B1Da=2 then FH_Sum+1; maternal grandfather
  + if B1Ea=2 then FH_Sum+1; paternal grandfather
- FH_FirstDeg=0;
  + if B1Aa=2 then FH_FirstDeg+1; father
  + if B1Ba=2 then FH_FirstDeg+1; any brother
  + if B1Ca=2 then FH_FirstDeg+1; any son
- FH_SecDeg=0;
  + if B1Da=2 then FH_Sum+1; maternal grandfather
  + if B1Ea=2 then FH_Sum+1; paternal grandfather

```{r b1-create}
  temp.d$FH_Sum <- rep(0,nrow(temp.d))
  temp.d$FH_FirstDeg <- rep(0,nrow(temp.d))
  temp.d$FH_SecDeg <- rep(0,nrow(temp.d))
  
  
  #for (i in 1:nrow(temp.d)){
    #for (j in 2:6){
      #if(!is.na(temp.d[i,j])&&temp.d[i,j]=="Yes"){
         #temp.d[i,"FH_Sum"]<-temp.d[i,"FH_Sum"]+1
      #}
    #}
  #}  
  
  
  for (i in 1:nrow(temp.d)){
    #if(!is.na(temp.d[i,"b1aa"])){
       if(!is.na(temp.d[i,"b1aa"])&&temp.d[i,"b1aa"]=="Yes"){
         temp.d[i,"FH_Sum"]<-temp.d[i,"FH_Sum"]+1
         temp.d[i,"FH_FirstDeg"]<-temp.d[i,"FH_FirstDeg"]+1
       }
     #}
    if(!is.na(temp.d[i,"b1ba"])){
       if(temp.d[i,"b1ba"]=="Yes"){
         temp.d[i,"FH_Sum"]<-temp.d[i,"FH_Sum"]+1
         temp.d[i,"FH_FirstDeg"]<-temp.d[i,"FH_FirstDeg"]+1
       }
    }
    if(!is.na(temp.d[i,"b1ca"])){
       if(temp.d[i,"b1ca"]=="Yes"){
         temp.d[i,"FH_Sum"]<-temp.d[i,"FH_Sum"]+1
         temp.d[i,"FH_FirstDeg"]<-temp.d[i,"FH_FirstDeg"]+1
       }
    }
    if(!is.na(temp.d[i,"b1da"])){
       if(temp.d[i,"b1da"]=="Yes "){
         temp.d[i,"FH_Sum"]<-temp.d[i,"FH_Sum"]+1
         temp.d[i,"FH_SecDeg"]<-temp.d[i,"FH_SecDeg"]+1
       }
    }
    if(!is.na(temp.d[i,"b1ea"])){
       if(temp.d[i,"b1ea"]=="Yes"){
         temp.d[i,"FH_Sum"]<-temp.d[i,"FH_Sum"]+1
         temp.d[i,"FH_SecDeg"]<-temp.d[i,"FH_SecDeg"]+1
       }
     }
     
  }
  new.d <- data.frame(new.d, temp.d$FH_Sum)
  new.d <- data.frame(new.d, temp.d$FH_FirstDeg)
  new.d <- data.frame(new.d, temp.d$FH_SecDeg)


  
```  
  
## All data
```{r b1-table, message=FALSE}  
  m<- data.frame(mean(temp.d$FH_Sum),mean(temp.d$FH_FirstDeg),mean(temp.d$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.d$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.d$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.d$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.d$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.d$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.d$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
```  

## Detroit
```{r b1-table1, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
``` 
## Georgia
```{r b1-table2, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
``` 
## Greater Bay
```{r b1-table3, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
```
## Greater CA
```{r b1-table4, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
```
## LA
```{r b1-table5, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
```
## Louisiana
```{r b1-table6, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
```
## New Jersey
```{r b1-table7, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
```
## Texas
```{r b1-table8, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
```
## Virtual
```{r b1-table9, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  m<- data.frame(mean(temp.dd$FH_Sum),mean(temp.dd$FH_FirstDeg),mean(temp.dd$FH_SecDeg))
  colnames(m)<-c("FH_Sum","FH_FirstDeg","FH_SecDeg")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$FH_Sum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_FirstDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  summarytools::view(dfSummary(temp.dd$FH_SecDeg, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$FH_Sum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_Sum")
  result<-questionr::freq(temp.dd$FH_FirstDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_FirstDeg")
  result<-questionr::freq(temp.dd$FH_SecDeg,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "FH_SecDeg")
rm(temp.dd)
```

# B3 {.tabset}
- B3. In general, how would you rate your current health?  
   + 1=Excellent  
   + 2=Very Good  
   + 3=Good  
   + 4=Fair  
   + 5=Poor
   
## All data
```{r B3: current health }
  b3 <- as.factor(d[,"b3"])
# Make "*" to NA
  b3[which(b3=="*")]<-"NA"
  levels(b3) <- list(Excellent="1",
                     Very_Good="2",
                     Good="3",
                     Fair="4",
                     Poor="5")
  b3 <- ordered(b3, c("Excellent","Very_Good","Good","Fair","Poor"))

  new.d <- data.frame(new.d, b3)
  new.d <- apply_labels(new.d, b3 = "Current Health")
  temp.d <- data.frame (new.d, b3)  
  
  result<-questionr::freq(temp.d$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r b31, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r b32, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r b33, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r b34, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r b35, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r b36, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r b37, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r b38, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r b39, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$b3, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd)

```
 
# B4 {.tabset}
- B4. Has the doctor ever told you that you have/had…
   + Heart Attack
   + Heart Failure or CHF
   + Stroke
   + Hypertension
   + Peripheral arterial disease
   + High Cholesterol
   + Asthma, COPD
   + Stomach ulcers
   + Crohn's Disease
   + Diabetes
   + Kidney Problems
   + Cirrhosis, liver damage
   + Arthritis
   + Dementia
   + Depression
   + AIDS
   + Other Cancer
   
## All data

```{r B4: Comorbidities}
# Heart Attack
  b4aa <- as.factor(d[,"b4aa"])
# Make "*" to NA
  b4aa[which(b4aa=="*")]<-"NA"
  levels(b4aa) <- list(No="1",
                     Yes="2")
  b4aa <- ordered(b4aa, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4aa)
  new.d <- apply_labels(new.d, b4aa = "Heart Attack")
  temp.d <- data.frame (new.d, b4aa)
  
  result<-questionr::freq(temp.d$b4aa, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  b4ba <- as.factor(d[,"b4ba"])
  # Make "*" to NA
  b4ba[which(b4ba=="*")]<-"NA"
  levels(b4ba) <- list(No="1",
                     Yes="2")
  b4ba <- ordered(b4ba, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ba)
  new.d <- apply_labels(new.d, b4ba = "Heart Failure or CHF")
  temp.d <- data.frame (new.d, b4ba)  
  
  result<-questionr::freq(temp.d$b4ba, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")  
# Stroke  
  b4ca <- as.factor(d[,"b4ca"])
  # Make "*" to NA
  b4ca[which(b4ca=="*")]<-"NA"
  levels(b4ca) <- list(No="1",
                     Yes="2")
  b4ca <- ordered(b4ca, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ca)
  new.d <- apply_labels(new.d, b4ca = "Stroke")
  temp.d <- data.frame (new.d, b4ca)  
  
  result<-questionr::freq(temp.d$b4ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  b4da <- as.factor(d[,"b4da"])
  # Make "*" to NA
  b4da[which(b4da=="*")]<-"NA"
  levels(b4da) <- list(No="1",
                     Yes="2")
  b4da <- ordered(b4da, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4da)
  new.d <- apply_labels(new.d, b4da = "Hypertension")
  temp.d <- data.frame (new.d, b4da)  

  result<-questionr::freq(temp.d$b4da, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension") 
# Peripheral arterial disease 
  b4ea <- as.factor(d[,"b4ea"])
  # Make "*" to NA
  b4ea[which(b4ea=="*")]<-"NA"
  levels(b4ea) <- list(No="1",
                     Yes="2")
  b4ea <- ordered(b4ea, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ea)
  new.d <- apply_labels(new.d, b4ea = "Peripheral arterial disease")
  temp.d <- data.frame (new.d, b4ea)  
  
  result<-questionr::freq(temp.d$b4ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  b4fa <- as.factor(d[,"b4fa"])
  # Make "*" to NA
  b4fa[which(b4fa=="*")]<-"NA"
  levels(b4fa) <- list(No="1",
                     Yes="2")
  b4fa <- ordered(b4fa, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4fa)
  new.d <- apply_labels(new.d, b4fa = "High Cholesterol")
  temp.d <- data.frame (new.d, b4fa)  
  
  result<-questionr::freq(temp.d$b4fa, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol") 
#  Asthma, COPD
  b4ga <- as.factor(d[,"b4ga"])
  # Make "*" to NA
  b4ga[which(b4ga=="*")]<-"NA"
  levels(b4ga) <- list(No="1",
                     Yes="2")
  b4ga <- ordered(b4ga, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ga)
  new.d <- apply_labels(new.d, b4ga = "Asthma, COPD")
  temp.d <- data.frame (new.d, b4ga)  

  result<-questionr::freq(temp.d$b4ga, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD")
# Stomach ulcers
  b4ha <- as.factor(d[,"b4ha"])
  # Make "*" to NA
  b4ha[which(b4ha=="*")]<-"NA"
  levels(b4ha) <- list(No="1",
                     Yes="2")
  b4ha <- ordered(b4ha, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ha)
  new.d <- apply_labels(new.d, b4ha = "Stomach ulcers")
  temp.d <- data.frame (new.d, b4ha)  
  
  result<-questionr::freq(temp.d$b4ha, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers") 
# Crohn's Disease
  b4ia <- as.factor(d[,"b4ia"])
  # Make "*" to NA
  b4ia[which(b4ia=="*")]<-"NA"
  levels(b4ia) <- list(No="1",
                     Yes="2")
  b4ia <- ordered(b4ia, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ia)
  new.d <- apply_labels(new.d, b4ia = "Crohn's Disease")
  temp.d <- data.frame (new.d, b4ia)  

  result<-questionr::freq(temp.d$b4ia, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  b4ja <- as.factor(d[,"b4ja"])
  # Make "*" to NA
  b4ja[which(b4ja=="*")]<-"NA"
  levels(b4ja) <- list(No="1",
                     Yes="2")
  b4ja <- ordered(b4ja, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ja)
  new.d <- apply_labels(new.d, b4ja = "Diabetes")
  temp.d <- data.frame (new.d, b4ja)  
  
  result<-questionr::freq(temp.d$b4ja, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  b4ka <- as.factor(d[,"b4ka"])
  # Make "*" to NA
  b4ka[which(b4ka=="*")]<-"NA"
  levels(b4ka) <- list(No="1",
                     Yes="2")
  b4ka <- ordered(b4ka, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ka)
  new.d <- apply_labels(new.d, b4ka = "Kidney Problems")
  temp.d <- data.frame (new.d, b4ka)  

  result<-questionr::freq(temp.d$b4ka, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  b4la <- as.factor(d[,"b4la"])
  # Make "*" to NA
  b4la[which(b4la=="*")]<-"NA"
  levels(b4la) <- list(No="1",
                     Yes="2")
  b4la <- ordered(b4la, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4la)
  new.d <- apply_labels(new.d, b4la = "Cirrhosis, liver damage")
  temp.d <- data.frame (new.d, b4la)  
  
  result<-questionr::freq(temp.d$b4la, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  b4ma <- as.factor(d[,"b4ma"])
  # Make "*" to NA
  b4ma[which(b4ma=="*")]<-"NA"
  levels(b4ma) <- list(No="1",
                     Yes="2")
  b4ma <- ordered(b4ma, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4ma)
  new.d <- apply_labels(new.d, b4ma = "Arthritis")
  temp.d <- data.frame (new.d, b4ma)  

  result<-questionr::freq(temp.d$b4ma, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
  b4na <- as.factor(d[,"b4na"])
  # Make "*" to NA
  b4na[which(b4na=="*")]<-"NA"
  levels(b4na) <- list(No="1",
                     Yes="2")
  b4na <- ordered(b4na, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4na)
  new.d <- apply_labels(new.d, b4na = "Dementia")
  temp.d <- data.frame (new.d, b4na)  

  result<-questionr::freq(temp.d$b4na, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  b4oa <- as.factor(d[,"b4oa"])
  # Make "*" to NA
  b4oa[which(b4oa=="*")]<-"NA"
  levels(b4oa) <- list(No="1",
                     Yes="2")
  b4oa <- ordered(b4oa, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4oa)
  new.d <- apply_labels(new.d, b4oa = "Depression")
  temp.d <- data.frame (new.d, b4oa)  

  result<-questionr::freq(temp.d$b4oa, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  b4pa <- as.factor(d[,"b4pa"])
  # Make "*" to NA
  b4pa[which(b4pa=="*")]<-"NA"
  levels(b4pa) <- list(No="1",
                     Yes="2")
  b4pa <- ordered(b4pa, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4pa)
  new.d <- apply_labels(new.d, b4pa = "AIDS")
  temp.d <- data.frame (new.d, b4pa)  

  result<-questionr::freq(temp.d$b4pa, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  b4qa <- as.factor(d[,"b4qa"])
  # Make "*" to NA
  b4qa[which(b4qa=="*")]<-"NA"
  levels(b4qa) <- list(No="1",
                     Yes="2")
  b4qa <- ordered(b4qa, c("No", "Yes"))
  
  new.d <- data.frame(new.d, b4qa)
  new.d <- apply_labels(new.d, b4qa = "Other Cancer")
  temp.d <- data.frame (new.d, b4qa)
  
  result<-questionr::freq(temp.d$b4qa, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
```  

## Detroit
```{r b41, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
  
rm(temp.dd) 
```

## Georgia
```{r b42, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```

## Greater Bay
```{r b43, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```

## Greater CA
```{r b44, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```

## LA
```{r b45, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```

## Louisiana
```{r b46, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```

## New Jersey
```{r b47, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```

## Texas
```{r b48, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```

## Virtual
```{r b49, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  # Heart Attack
  result<-questionr::freq(temp.dd$b4aa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Attack")
# Heart Failure or CHF
  result<-questionr::freq(temp.dd$b4ba ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Heart Failure or CHF")
# Stroke  
  result<-questionr::freq(temp.dd$b4ca ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stroke")
# Hypertension 
  result<-questionr::freq(temp.dd$b4da ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Hypertension")
# Peripheral arterial disease 
  result<-questionr::freq(temp.dd$b4ea ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Peripheral arterial disease")
# High Cholesterol 
  result<-questionr::freq(temp.dd$b4fa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "High Cholesterol")  
#  Asthma, COPD
  result<-questionr::freq(temp.dd$b4ga ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Asthma, COPD") 
# Stomach ulcers
  result<-questionr::freq(temp.dd$b4ha ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Stomach ulcers")
# Crohn's Disease
  result<-questionr::freq(temp.dd$b4ia ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Crohn's Disease")
# Diabetes
  result<-questionr::freq(temp.dd$b4ja ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Diabetes")
# Kidney Problems
  result<-questionr::freq(temp.dd$b4ka ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Kidney Problems")
# Cirrhosis, liver damage
  result<-questionr::freq(temp.dd$b4la ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Cirrhosis, liver damage")
# Arthritis
  result<-questionr::freq(temp.dd$b4ma ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Arthritis")
# Dementia
 result<-questionr::freq(temp.dd$b4na ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Dementia")
# Depression 
  result<-questionr::freq(temp.dd$b4oa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Depression")
# AIDS
  result<-questionr::freq(temp.dd$b4pa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "AIDS")
# Other Cancer
  result<-questionr::freq(temp.dd$b4qa ,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Other Cancer")
rm(temp.dd) 
```










# B4 - Comorbidities {.tabset}
- Based on B4.
- ComorbScore=0;
  + If B4Aa=2 then ComorbScore+1;
  + If B4Ba=2 then ComorbScore+1;
  + If B4Ca=2 then ComorbScore+1;
  + If B4Da=2 then ComorbScore+1;
  + If B4Ea=2 then ComorbScore+1;
  + If B4Fa=2 then ComorbScore+1;
  + If B4Ga=2 then ComorbScore+1;
  + If B4Ha=2 then ComorbScore+1;
  + If B4Ia=2 then ComorbScore+1;
  + If B4Ja=2 then ComorbScore+1;
  + If B4Ka=2 then ComorbScore+1;
  + If B4La=2 then ComorbScore+1;
  + If B4Ma=2 then ComorbScore+1;
  + If B4Na=2 then ComorbScore+1;
  + If B4Oa=2 then ComorbScore+1;
  + If B4Pa=2 then ComorbScore+1;
  + If B4Qa=2 then ComorbScore+1;

```{r b4-create}
  temp.d$ComorbScore <- rep(0,nrow(temp.d))

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,"b4aa"])){
       if(temp.d[i,"b4aa"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
     }
    if(!is.na(temp.d[i,"b4ba"])){
       if(temp.d[i,"b4ba"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ca"])){
       if(temp.d[i,"b4ca"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4da"])){
       if(temp.d[i,"b4da"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ea"])){
       if(temp.d[i,"b4ea"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4fa"])){
       if(temp.d[i,"b4fa"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ga"])){
       if(temp.d[i,"b4ga"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ha"])){
       if(temp.d[i,"b4ha"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ia"])){
       if(temp.d[i,"b4ia"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ja"])){
       if(temp.d[i,"b4ja"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ka"])){
       if(temp.d[i,"b4ka"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4la"])){
       if(temp.d[i,"b4la"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4ma"])){
       if(temp.d[i,"b4ma"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4na"])){
       if(temp.d[i,"b4na"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4oa"])){
       if(temp.d[i,"b4oa"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4pa"])){
       if(temp.d[i,"b4pa"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
    if(!is.na(temp.d[i,"b4qa"])){
       if(temp.d[i,"b4qa"]=="Yes"){
         temp.d[i,"ComorbScore"]<-temp.d[i,"ComorbScore"]+1
       }
    }
  }
``` 

## All data
``` {r b4-ComorbScore, message=FALSE}
  m<- data.frame(mean(temp.d$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.d$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.d$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
```  
  
## Detroit
``` {r b4-1, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## Georgia
``` {r b4-2, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## Greater Bay
``` {r b4-3, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## Greater CA
``` {r b4-4, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## LA
``` {r b4-5, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## Louisiana
``` {r b4-6, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## New Jersey
``` {r b4-7, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## Texas
``` {r b4-8, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
## Virtual  
``` {r b4-9, message=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  m<- data.frame(mean(temp.dd$ComorbScore))
  colnames(m)<-c("ComorbScore")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.dd$ComorbScore, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  
  result<-questionr::freq(temp.dd$ComorbScore,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ComorbScore") 
rm(temp.dd)
```
  
# B5 {.tabset}
- B5. Where do you usually go for routine medical care (seeing a doctor for any reason, not just for cancer care)?
  + 1=Community health center or free clinic
  + 2=Hospital (not emergency)/ urgent care clinic
  + 3=Private doctor's office 
  + 4=Emergency room 
  + 5=Veteran's Affairs/VA
  + 6=Other type of location
  
## All data
```{r B5}
  b5 <- as.factor(d[,"b5"])
# Make "*" to NA
  b5[which(b5=="*")]<-"NA"
  levels(b5) <- list(Community_center_free_clinic="1",
                     Hospital_urgent_care_clinic="2",
                     Private_Dr_office="3",
                     ER="4",
                     VA="5",
                     Other="6")
  b5 <- ordered(b5, c("Community_center_free_clinic", "Hospital_urgent_care_clinic", "Private_Dr_office", "ER","VA","Other"))
  
  new.d <- data.frame(new.d, b5)
  new.d <- apply_labels(new.d, b5 = "routine medical care")
  temp.d <- data.frame (new.d, b5)  
  
  result<-questionr::freq(temp.d$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r b51, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r b52, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r b53, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r b54, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r b55, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r b56, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r b57, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r b58, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r b59, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$b5 ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```  
  

# C1 {.tabset}
- C1. How many years have you lived in your current address?
  + 1=Less than 1 year 
  + 2=1-5 years
  + 3=6-10 years
  + 4=11-15 years
  + 5=16-20 years
  + 6=21+ years

## All data
```{r C1}
  c1 <- as.factor(d[,"c1"])
# Make "*" to NA
  c1[which(c1=="*")]<-"NA"
  levels(c1) <- list(Less_than_1_year="1",
                     years_1_5="2",
                     years_6_10="3",
                     years_11_15="4",
                     years_16_20="5",
                     years_21_more="6")
  c1 <- ordered(c1, c("Less_than_1_year", "years_1_5", "years_6_10", "years_11_15","years_16_20","years_21_more"))
  
  new.d <- data.frame(new.d, c1)
  new.d <- apply_labels(new.d, c1 = "living period")
  temp.d <- data.frame (new.d, c1)  
  
  result<-questionr::freq(temp.d$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r c11, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r c12, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r c13, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r c14, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r c15, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r c16, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r c17, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r c18, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r c19, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$c1, cum = TRUE ,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```  
  

# D1 {.tabset} 
- D1. In the following questions, we are interested in your perceptions about the way other people have treated you because of your race/ethnicity or skin color.

## All data
```{r D1}
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  d1aa <- as.factor(d[,"d1aa"])
# Make "*" to NA
  d1aa[which(d1aa=="*")]<-"NA"
  levels(d1aa) <- list(No="1",
                     Yes="2")
  d1aa <- ordered(d1aa, c("No","Yes"))
  
  new.d <- data.frame(new.d, d1aa)
  new.d <- apply_labels(new.d, d1aa = "fired or denied a promotion")
  temp.d <- data.frame (new.d, d1aa)  
  
  result<-questionr::freq(temp.d$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  d1ba <- as.factor(d[,"d1ba"])
# Make "*" to NA
  d1ba[which(d1ba=="*")]<-"NA"
  levels(d1ba) <- list(No="1",
                     Yes="2")
  d1ba <- ordered(d1ba, c("No","Yes"))
  
  new.d <- data.frame(new.d, d1ba)
  new.d <- apply_labels(new.d, d1ba = "not be hired")
  temp.d <- data.frame (new.d, d1ba)  
  
  result<-questionr::freq(temp.d$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  d1ca <- as.factor(d[,"d1ca"])
# Make "*" to NA
  d1ca[which(d1ca=="*")]<-"NA"
  levels(d1ca) <- list(No="1",
                     Yes="2")
  d1ca <- ordered(d1ca, c( "No","Yes"))
  
  new.d <- data.frame(new.d, d1ca)
  new.d <- apply_labels(new.d, d1ca = "By police")
  temp.d <- data.frame (new.d, d1ca)  
  
  result<-questionr::freq(temp.d$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  d1da <- as.factor(d[,"d1da"])
# Make "*" to NA
  d1da[which(d1da=="*")]<-"NA"
  levels(d1da) <- list(No="1",
                     Yes="2")
  d1da <- ordered(d1da, c( "No","Yes"))
  
  new.d <- data.frame(new.d, d1da)
  new.d <- apply_labels(new.d, d1da = "unfair education")
  temp.d <- data.frame (new.d, d1da)  
  
  result<-questionr::freq(temp.d$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  d1ea <- as.factor(d[,"d1ea"])
# Make "*" to NA
  d1ea[which(d1ea=="*")]<-"NA"
  levels(d1ea) <- list(No="1",
                     Yes="2")
  d1ea <- ordered(d1ea, c("No","Yes"))
  
  new.d <- data.frame(new.d, d1ea)
  new.d <- apply_labels(new.d, d1ea = "moving into a neighborhood")
  temp.d <- data.frame (new.d, d1ea)  
  
  result<-questionr::freq(temp.d$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f.   Have   you   ever   been   unfairly denied a bank loan?
  d1fa <- as.factor(d[,"d1fa"])
# Make "*" to NA
  d1fa[which(d1fa=="*")]<-"NA"
  levels(d1fa) <- list(No="1",
                     Yes="2")
  d1fa <- ordered(d1fa, c("No","Yes"))
  
  new.d <- data.frame(new.d, d1fa)
  new.d <- apply_labels(new.d, d1fa = "Bank loan")
  temp.d <- data.frame (new.d, d1fa)  
  
  result<-questionr::freq(temp.d$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan?")
# g.   Have   you   ever   been   unfairly treated when getting medical care?
  d1ga <- as.factor(d[,"d1ga"])
# Make "*" to NA
  d1ga[which(d1ga=="*")]<-"NA"
  levels(d1ga) <- list(No="1",
                     Yes="2")
  d1ga <- ordered(d1ga, c("No","Yes"))
  
  new.d <- data.frame(new.d, d1ga)
  new.d <- apply_labels(new.d, d1ga = "unfair medical care")
  temp.d <- data.frame (new.d, d1ga)  
  
  result<-questionr::freq(temp.d$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
```

## Detroit
```{r D11, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## Georgia
```{r D12, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## Greater Bay
```{r D13, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## Greater CA
```{r D14, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## LA
```{r D15, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## Louisiana
```{r D16, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## New Jersey
```{r D17, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## Texas
```{r D18, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

## Virtual
```{r D19, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
# a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?
  result<-questionr::freq(temp.dd$d1aa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. At any time in your life, have you ever been unfairly fired from a job or been unfairly denied a promotion?")
# b. For unfair reasons, have you ever not been hired for a job?
  result<-questionr::freq(temp.dd$d1ba,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. For unfair reasons, have you ever not been hired for a job?")
# c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?
  result<-questionr::freq(temp.dd$d1ca,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Have you ever been unfairly stopped, searched, questioned, physically threatened or abused by the police?")
# d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?
  result<-questionr::freq(temp.dd$d1da,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Have you ever been unfairly discouraged by a teacher or advisor from continuing your education?")
# e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?
  result<-questionr::freq(temp.dd$d1ea,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Have you ever been unfairly prevented from moving into a neighborhood because the landlord or a realtor refused to sell or rent you a house or apartment?")
# f. Have you ever been unfairly denied a bank loan? 
  result<-questionr::freq(temp.dd$d1fa,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. Have you ever been unfairly denied a bank loan? ")
# g. Have you ever been unfairly treated when getting medical care?
  result<-questionr::freq(temp.dd$d1ga,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. Have you ever been unfairly treated when getting medical care?")
rm(temp.dd) 
```

# D1 - Discrimination summary score {.tabset}  
- Perception about the way other people have treated you because of your race/ethnicity or skin color
- DiscSum=0;
  + If D1Aa=2 then DiscSum+1;
  + If D1Ba=2 then DiscSum+1;
  + If D1Ca=2 then DiscSum+1;
  + If D1Da=2 then DiscSum+1;
  + If D1Ea=2 then DiscSum+1;
  + If D1Fa=2 then DiscSum+1;
  + If D1Ga=2 then DiscSum+1;

```{r D1-create}
  temp.d$DiscSum <- rep(0,nrow(temp.d))
  
  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,"d1aa"])){
       if(temp.d[i,"d1aa"]=="Yes"){
         temp.d[i,"DiscSum"]<-temp.d[i,"DiscSum"]+1
       }
     }
    if(!is.na(temp.d[i,"d1ba"])){
       if(temp.d[i,"d1ba"]=="Yes"){
         temp.d[i,"DiscSum"]<-temp.d[i,"DiscSum"]+1
       }
    }
    if(!is.na(temp.d[i,"d1ca"])){
       if(temp.d[i,"d1ca"]=="Yes"){
         temp.d[i,"DiscSum"]<-temp.d[i,"DiscSum"]+1
       }
    }
    if(!is.na(temp.d[i,"d1da"])){
       if(temp.d[i,"d1da"]=="Yes"){
         temp.d[i,"DiscSum"]<-temp.d[i,"DiscSum"]+1
       }
    }
    if(!is.na(temp.d[i,"d1ea"])){
       if(temp.d[i,"d1ea"]=="Yes"){
         temp.d[i,"DiscSum"]<-temp.d[i,"DiscSum"]+1
       }
     }
     if(!is.na(temp.d[i,"d1fa"])){
       if(temp.d[i,"d1fa"]=="Yes"){
         temp.d[i,"DiscSum"]<-temp.d[i,"DiscSum"]+1
       }
     }
    if(!is.na(temp.d[i,"d1ga"])){
       if(temp.d[i,"d1ga"]=="Yes"){
         temp.d[i,"DiscSum"]<-temp.d[i,"DiscSum"]+1
       }
     }
  }

```

## All data
```{r D1-table, message=FALSE}  
  m<- data.frame(mean(temp.d$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  
  summarytools::view(dfSummary(temp.d$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.d$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
```

## Detroit
```{r D1-table1, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```  

## Georgia
```{r D1-table2, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```
## Greater Bay
```{r D1-table3, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```
## Greater CA
```{r D1-table4, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```
## LA
```{r D1-table5, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```
## Louisiana
```{r D1-table6, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```
## New Jersey
```{r D1-table7, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```
## Texas
```{r D1-table8, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```
## Virtual
```{r D1-table9, message=FALSE}  
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  m<- data.frame(mean(temp.dd$DiscSum))
  colnames(m)<-c("DiscSum")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$DiscSum, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$DiscSum,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "DiscSum")
rm(temp.dd)
```

# D2 {.tabset}
- D2. These next questions are about your current feelings or perceptions regarding healthcare organizations (places where you might get healthcare, like a hospital or clinic). Indicate your level of agreement or disagreement with each statement.

## All data
```{r D2: Medical Mistrust}
# a. Patients have sometimes been deceived or misled at hospitals.
  d2a <- as.factor(d[,"d2a"])
# Make "*" to NA
  d2a[which(d2a=="*")]<-"NA"
  levels(d2a) <- list(Strongly_Agree="1",
                     Somewhat_Agree="2",
                     Somewhat_Disagree="3",
                     Strongly_Disagree="4")
  d2a <- ordered(d2a, c("Strongly_Agree","Somewhat_Agree","Somewhat_Disagree","Strongly_Disagree"))
  
  new.d <- data.frame(new.d, d2a)
  new.d <- apply_labels(new.d, d2a = "deceived or misled")
  temp.d <- data.frame (new.d, d2a)  
  
  result<-questionr::freq(temp.d$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  d2b <- as.factor(d[,"d2b"])
# Make "*" to NA
  d2b[which(d2b=="*")]<-"NA"
  levels(d2b) <- list(Strongly_Agree="1",
                     Somewhat_Agree="2",
                     Somewhat_Disagree="3",
                     Strongly_Disagree="4")
  d2b <- ordered(d2b, c("Strongly_Agree","Somewhat_Agree","Somewhat_Disagree","Strongly_Disagree"))
  
  new.d <- data.frame(new.d, d2b)
  new.d <- apply_labels(new.d, d2b = "personal affairs")
  temp.d <- data.frame (new.d, d2b)  
  
  result<-questionr::freq(temp.d$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  d2c <- as.factor(d[,"d2c"])
# Make "*" to NA
  d2c[which(d2c=="*")]<-"NA"
  levels(d2c) <- list(Strongly_Agree="1",
                     Somewhat_Agree="2",
                     Somewhat_Disagree="3",
                     Strongly_Disagree="4")
  d2c <- ordered(d2c, c("Strongly_Agree","Somewhat_Agree","Somewhat_Disagree","Strongly_Disagree"))
  
  new.d <- data.frame(new.d, d2c)
  new.d <- apply_labels(new.d, d2c = "harmful experiments")
  temp.d <- data.frame (new.d, d2c)  
  
  result<-questionr::freq(temp.d$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  d2d <- as.factor(d[,"d2d"])
# Make "*" to NA
  d2d[which(d2d=="*")]<-"NA"
  levels(d2d) <- list(Strongly_Agree="1",
                     Somewhat_Agree="2",
                     Somewhat_Disagree="3",
                     Strongly_Disagree="4")
  d2d <- ordered(d2d, c( "Strongly_Agree","Somewhat_Agree","Somewhat_Disagree","Strongly_Disagree"))
  
  new.d <- data.frame(new.d, d2d)
  new.d <- apply_labels(new.d, d2d = "Rich patients better care")
  temp.d <- data.frame (new.d, d2d)  
  
  result<-questionr::freq(temp.d$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  d2e <- as.factor(d[,"d2e"])
# Make "*" to NA
  d2e[which(d2e=="*")]<-"NA"
  levels(d2e) <- list(Strongly_Agree="1",
                     Somewhat_Agree="2",
                     Somewhat_Disagree="3",
                     Strongly_Disagree="4")
  d2e <- ordered(d2e, c("Strongly_Agree","Somewhat_Agree","Somewhat_Disagree","Strongly_Disagree"))
  
  new.d <- data.frame(new.d, d2e)
  new.d <- apply_labels(new.d, d2e = "Male patients better care")
  temp.d <- data.frame (new.d, d2e)  
  
  result<-questionr::freq(temp.d$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
```

## Detroit
```{r D21, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## Georgia
```{r D22, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## Greater Bay
```{r D23, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## Greater CA
```{r D24, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## LA
```{r D25, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## Louisiana
```{r D26, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## New Jersey
```{r D27, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## Texas
```{r D28, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

## Virtual
```{r D29, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
# a. Patients have sometimes been deceived or misled at hospitals.
  result<-questionr::freq(temp.dd$d2a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Patients have sometimes been deceived or misled at hospitals.")
# b. Hospitals often want to know more about your personal affairs or business than they really need to know.
  result<-questionr::freq(temp.dd$d2b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Hospitals often want to know more about your personal affairs or business than they really need to know.")
# c. Hospitals have sometimes done harmful experiments on patients without their knowledge.
  result<-questionr::freq(temp.dd$d2c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Hospitals have sometimes done harmful experiments on patients without their knowledge.")
# d. Rich patients receive better care at hospitals than poor patients.
  result<-questionr::freq(temp.dd$d2d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. Male patients receive better care at hospitals than female patients.
  result<-questionr::freq(temp.dd$d2e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
rm(temp.dd) 
```

# D2 - Medical Mistrust {.tabset} 
- Based on D2.
- MedMis=0;
  + If .<D2A<3 then MedMis+1;
  + If .<D2B<3 then MedMis+1;
  + If .<D2C<3 then MedMis+1;
  + If .<D2D<3 then MedMis+1;
  + If .<D2E<3 then MedMis+1;

```{r d2-create}
  temp.d$MedMis <- rep(0,nrow(temp.d))

  
  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,"d2a"])){
       if(temp.d[i,"d2a"]=="Strongly_Agree" || temp.d[i,"d2a"]=="Somewhat_Agree" ){
         temp.d[i,"MedMis"]<-temp.d[i,"MedMis"]+1
       }
     }
    if(!is.na(temp.d[i,"d2b"])){
       if(temp.d[i,"d2b"]=="Strongly_Agree" || temp.d[i,"d2b"]=="Somewhat_Agree" ){
         temp.d[i,"MedMis"]<-temp.d[i,"MedMis"]+1
       }
    }
    if(!is.na(temp.d[i,"d2c"])){
       if(temp.d[i,"d2c"]=="Strongly_Agree" || temp.d[i,"d2c"]=="Somewhat_Agree" ){
         temp.d[i,"MedMis"]<-temp.d[i,"MedMis"]+1
       }
    }
    if(!is.na(temp.d[i,"d2d"])){
       if(temp.d[i,"d2d"]=="Strongly_Agree" || temp.d[i,"d2d"]=="Somewhat_Agree" ){
         temp.d[i,"MedMis"]<-temp.d[i,"MedMis"]+1
       }
    }
    if(!is.na(temp.d[i,"d2e"])){
       if(temp.d[i,"d2e"]=="Strongly_Agree" || temp.d[i,"d2e"]=="Somewhat_Agree" ){
         temp.d[i,"MedMis"]<-temp.d[i,"MedMis"]+1
       }
     }
     
  }
  new.d <- data.frame(new.d, temp.d$MedMis)
  names(new.d)[names(new.d) == 'temp.d.MedMis'] <- 'MedMis'
  rm(temp.d)
```  

## All data
```{r D2-table, message=FALSE}  
  m<- data.frame(mean(new.d$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(new.d$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(new.d$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
```

## Detroit
```{r D2-table1, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Detroit"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```  

## Georgia
```{r D2-table2, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Georgia"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```
## Greater Bay
```{r D2-table3, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater Bay"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```
## Greater CA
```{r D2-table4, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater California"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```
## LA
```{r D2-table5, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Los Angeles"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```
## Louisiana
```{r D2-table6, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Louisiana"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```
## New Jersey
```{r D2-table7, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "New Jersey"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```
## Texas
```{r D2-table8, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Texas"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```
## Virtual
```{r D2-table9, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Virtual"), ]
  m<- data.frame(mean(temp.dd$MedMis))
  colnames(m)<-c("MedMis")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$MedMis, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$MedMis,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "MedMis")
rm(temp.dd)
```

# D3 {.tabset}
- D3. In your day-to-day life, during the following 3 time periods, how often have any of the following things happened to you because of your race/ethnicity?

## All data
```{r D3: Everyday discrimination}
# a. You have been treated with less respect than other people
  d3a1 <- as.factor(d[,"d3a1"])
# Make "*" to NA
  d3a1[which(d3a1=="*")]<-"NA"
  levels(d3a1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3a1 <- ordered(d3a1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3a1)
  new.d <- apply_labels(new.d, d3a1 = "less respect")
  temp.d <- data.frame (new.d.1, d3a1)  
  
  result<-questionr::freq(temp.d$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  d3b1 <- as.factor(d[,"d3b1"])
# Make "*" to NA
  d3b1[which(d3b1=="*")]<-"NA"
  levels(d3b1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3b1 <- ordered(d3b1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3b1)
  new.d <- apply_labels(new.d, d3b1 = "poorer service")
  temp.d <- data.frame (temp.d, d3b1)  
  
  result<-questionr::freq(temp.d$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  d3c1 <- as.factor(d[,"d3c1"])
# Make "*" to NA
  d3c1[which(d3c1=="*")]<-"NA"
  levels(d3c1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3c1 <- ordered(d3c1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3c1)
  new.d <- apply_labels(new.d, d3c1 = "think you are not smart")
  temp.d <- data.frame (temp.d, d3c1)  
  
  result<-questionr::freq(temp.d$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  d3d1 <- as.factor(d[,"d3d1"])
# Make "*" to NA
  d3d1[which(d3d1=="*")]<-"NA"
  levels(d3d1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3d1 <- ordered(d3d1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3d1)
  new.d <- apply_labels(new.d, d3d1 = "be afraid of you")
  temp.d <- data.frame (temp.d, d3d1)  
  
  result<-questionr::freq(temp.d$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. People have acted as if they are afraid of you")
# e. People have acted as if they think you are dishonest
  d3e1 <- as.factor(d[,"d3e1"])
# Make "*" to NA
  d3e1[which(d3e1=="*")]<-"NA"
  levels(d3e1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3e1 <- ordered(d3e1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3e1)
  new.d <- apply_labels(new.d, d3e1 = "think you are dishonest")
  temp.d <- data.frame (temp.d, d3e1)  
  
  result<-questionr::freq(temp.d$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. People have acted as if they think you are dishonest")
# f. People have acted as if they’re better than you are
  d3f1 <- as.factor(d[,"d3f1"])
# Make "*" to NA
  d3f1[which(d3f1=="*")]<-"NA"
  levels(d3f1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3f1 <- ordered(d3f1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3f1)
  new.d <- apply_labels(new.d, d3f1 = "better than you")
  temp.d <- data.frame (temp.d, d3f1)  
  
  result<-questionr::freq(temp.d$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  d3g1 <- as.factor(d[,"d3g1"])
# Make "*" to NA
  d3g1[which(d3g1=="*")]<-"NA"
  levels(d3g1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3g1 <- ordered(d3g1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3g1)
  new.d <- apply_labels(new.d, d3g1 = "called names or insulted")
  temp.d <- data.frame (temp.d, d3g1)  
  
  result<-questionr::freq(temp.d$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  d3h1 <- as.factor(d[,"d3h1"])
# Make "*" to NA
  d3h1[which(d3h1=="*")]<-"NA"
  levels(d3h1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3h1 <- ordered(d3h1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3h1)
  new.d <- apply_labels(new.d, d3h1 = "threatened or harassed")
  temp.d <- data.frame (temp.d, d3h1)  
  
  result<-questionr::freq(temp.d$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  d3i1 <- as.factor(d[,"d3i1"])
# Make "*" to NA
  d3i1[which(d3i1=="*")]<-"NA"
  levels(d3i1) <- list(Never="1",
                     Rarely="2",
                     Sometimes="3",
                     Often="4")
  d3i1 <- ordered(d3i1, c("Never","Rarely","Sometimes","Often"))
  
  new.d <- data.frame(new.d, d3i1)
  new.d <- apply_labels(new.d, d3i1 = "threatened or harassed")
  temp.d <- data.frame (temp.d, d3i1)  
  
  result<-questionr::freq(temp.d$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
```


## Detroit
```{r D31, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## Georgia
```{r D32, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## Greater Bay
```{r D33, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## Greater CA
```{r D34, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## LA
```{r D35, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## Louisiana
```{r D36, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## New Jersey
```{r D37, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## Texas
```{r D38, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```

## Virtual
```{r D39, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
# a. You have been treated with less respect than other people
  result<-questionr::freq(temp.dd$d3a1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. You have been treated with less respect than other people")
# b. You have received poorer service than other people at restaurants or stores
  result<-questionr::freq(temp.dd$d3b1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. You have received poorer service than other people at restaurants or stores")
# c. People have acted as if they think you are not smart
  result<-questionr::freq(temp.dd$d3c1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. People have acted as if they think you are not smart")
# d. People have acted as if they are afraid of you
  result<-questionr::freq(temp.dd$d3d1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Rich patients receive better care at hospitals than poor patients.")
# e. People have acted as if they think you are dishonest
  result<-questionr::freq(temp.dd$d3e1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Male patients receive better care at hospitals than female patients.")
# f. People have acted as if they’re better than you are
  result<-questionr::freq(temp.dd$d3f1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. People have acted as if they’re better than you are")
# g. You have been called names or insulted
  result<-questionr::freq(temp.dd$d3g1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. You have been called names or insulted")
# h. You have been threatened or harassed
  result<-questionr::freq(temp.dd$d3h1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. You have been threatened or harassed")
# i. You have been followed around in stores
  result<-questionr::freq(temp.dd$d3i1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. You have been followed around in stores")
rm(temp.dd) 
```











# D3 - Everyday discrimination{.tabset}
- Based on D3.
- EverydayDisc=0;
  + If 2<D3A1<5 then EverydayDisc+1;
  + If 2<D3B1<5 then EverydayDisc+1;
  + If 2<D3C1<5 then EverydayDisc+1;
  + If 2<D3D1<5 then EverydayDisc+1;
  + If 2<D3E1<5 then EverydayDisc+1;
  + If 2<D3F1<5 then EverydayDisc+1;
  + If 2<D3G1<5 then EverydayDisc+1;
  + If 2<D3H1<5 then EverydayDisc+1;
  + If 2<D3I1<5 then EverydayDisc+1;
  
```{r d3-create}
  temp.d$EverydayDisc <- rep(0,nrow(temp.d))

  
  for (i in 1:nrow(temp.d)){
    for (j in 1:9){
      if(!is.na(temp.d[i,j])){
        if(temp.d[i,j]=="Sometimes"||temp.d[i,j]=="Often"){
           temp.d[i,"EverydayDisc"]<-temp.d[i,"EverydayDisc"]+1
        }
      }
    }
  } 

  new.d <- data.frame(new.d, temp.d$EverydayDisc)
  names(new.d)[names(new.d) == 'temp.d.EverydayDisc'] <- 'EverydayDisc'
  rm(temp.d)
```

## All data
```{r D3-table, message=FALSE}  
  m<- data.frame(mean(new.d$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(new.d$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(new.d$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
```

## Detroit
```{r D3-table1, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Detroit"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```  

## Georgia
```{r D3-table2, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Georgia"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```
## Greater Bay
```{r D3-table3, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater Bay"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```
## Greater CA
```{r D3-table4, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater California"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```
## LA
```{r D3-table5, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Los Angeles"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```
## Louisiana
```{r D3-table6, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Louisiana"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```
## New Jersey
```{r D3-table7, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "New Jersey"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```
## Texas
```{r D3-table8, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Texas"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```
## Virtual
```{r D3-table9, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Virtual"), ]
  m<- data.frame(mean(temp.dd$EverydayDisc))
  colnames(m)<-c("EverydayDisc")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$EverydayDisc, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$EverydayDisc,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "EverydayDisc")
rm(temp.dd)
```

# D5 {.tabset}
- D5. The next questions are about the time period of your childhood, before the age of 18. These are standard questions asked in many surveys of life history. This information will allow us to understand how problems that may occur early in life may affect health later in life. This is a sensitive topic and some people may feel uncomfortable with these questions. Please keep in mind that you can skip any question you do not want to answer. All information is kept confidential. When you were growing up, during the first 18 years of your life…

## All data
```{r D5: Childhood questions}
# a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  d5a <- as.factor(d[,"d5a"])
# Make "*" to NA
  d5a[which(d5a=="*")]<-"NA"
  levels(d5a) <- list(No="1",
                     Yes="2",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5a <- ordered(d5a, c("No","Yes","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5a)
  new.d <- apply_labels(new.d, d5a = "live with depressed")
  temp.d <- data.frame (new.d.1, d5a)  
  
  result<-questionr::freq(temp.d$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  d5b <- as.factor(d[,"d5b"])
# Make "*" to NA
  d5b[which(d5b=="*")]<-"NA"
  levels(d5b) <- list(No="1",
                     Yes="2",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5b <- ordered(d5b, c( "No","Yes","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5b)
  new.d <- apply_labels(new.d, d5b = "live with alcoholic")
  temp.d <- data.frame (temp.d, d5b)  
  
  result<-questionr::freq(temp.d$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  d5c <- as.factor(d[,"d5c"])
  # Make "*" to NA
  d5c[which(d5c=="*")]<-"NA"
  levels(d5c) <- list(No="1",
                     Yes="2",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5c <- ordered(d5c, c( "No","Yes","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5c)
  new.d <- apply_labels(new.d, d5c = "live with illegal street drugs")
  temp.d <- data.frame (temp.d, d5c)  
  
  result<-questionr::freq(temp.d$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? 
  d5d <- as.factor(d[,"d5d"])
  # Make "*" to NA
  d5d[which(d5d=="*")]<-"NA"
  levels(d5d) <- list(No="1",
                     Yes="2",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5d <- ordered(d5d, c( "No","Yes","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5d)
  new.d <- apply_labels(new.d, d5d = "live with people in a prison")
  temp.d <- data.frame (temp.d, d5d)  
  
  result<-questionr::freq(temp.d$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, etc?")
# e. Were your parents separated or divorced? 
  d5e <- as.factor(d[,"d5e"])
  # Make "*" to NA
  d5e[which(d5e=="*")]<-"NA"
  levels(d5e) <- list(No="1",
                     Yes="2",
                     Not_married="3",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5e <- ordered(d5e, c( "No","Yes","Not_married","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5e)
  new.d <- apply_labels(new.d, d5e = "parents divorced")
  temp.d <- data.frame (temp.d, d5e)  
  
  result<-questionr::freq(temp.d$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced?")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  d5f <- as.factor(d[,"d5f"])
  # Make "*" to NA
  d5f[which(d5f=="*")]<-"NA"
  levels(d5f) <- list(Never="1",
                     Once="2",
                     More_than_once="3",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5f <- ordered(d5f, c("Never", "Once","More_than_once","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5f)
  new.d <- apply_labels(new.d, d5f = "violence to each other")
  temp.d <- data.frame (temp.d, d5f)  
  
  result<-questionr::freq(temp.d$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
#  g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  d5g <- as.factor(d[,"d5g"])
  # Make "*" to NA
  d5g[which(d5g=="*")]<-"NA"
  levels(d5g) <- list(Never="1",
                     Once="2",
                     More_than_once="3",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5g <- ordered(d5g, c("Never", "Once","More_than_once","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5g)
  new.d <- apply_labels(new.d, d5g = "violence to you")
  temp.d <- data.frame (temp.d, d5g)  
  
  result<-questionr::freq(temp.d$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  d5h <- as.factor(d[,"d5h"])
# Make "*" to NA
  d5h[which(d5h=="*")]<-"NA"
  levels(d5h) <- list(Never="1",
                     Once="2",
                     More_than_once="3",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5h <- ordered(d5h, c("Never", "Once","More_than_once","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5h)
  new.d <- apply_labels(new.d, d5h = "swear insult")
  temp.d <- data.frame (temp.d, d5h)  
  
  result<-questionr::freq(temp.d$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  d5i <- as.factor(d[,"d5i"])
  # Make "*" to NA
  d5i[which(d5i=="*")]<-"NA"
  levels(d5i) <- list(Never="1",
                     Once="2",
                     More_than_once="3",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5i <- ordered(d5i, c("Never", "Once","More_than_once","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5i)
  new.d <- apply_labels(new.d, d5i = "touch you sexually")
  temp.d <- data.frame (temp.d, d5i)  
  
  result<-questionr::freq(temp.d$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  d5j <- as.factor(d[,"d5j"])
  # Make "*" to NA
  d5j[which(d5j=="*")]<-"NA"
  levels(d5j) <- list(Never="1",
                     Once="2",
                     More_than_once="3",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5j <- ordered(d5j, c("Never","Once","More_than_once","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5j)
  new.d <- apply_labels(new.d, d5j = "touch them sexually")
  temp.d <- data.frame (temp.d, d5j)  
  
  result<-questionr::freq(temp.d$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  d5k <- as.factor(d[,"d5k"])
  # Make "*" to NA
  d5k[which(d5k=="*")]<-"NA"
  levels(d5k) <- list(Never="1",
                     Once="2",
                     More_than_once="3",
                     Dont_know_not_sure="88",
                     Prefer_not_to_answer="99")
  d5k <- ordered(d5k, c("Never","Once","More_than_once","Dont_know_not_sure","Prefer_not_to_answer"))
  
  new.d <- data.frame(new.d, d5k)
  new.d <- apply_labels(new.d, d5k = "forced to have sex")
  temp.d <- data.frame (temp.d, d5k)  
  
  result<-questionr::freq(temp.d$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")

```

## Detroit
```{r d51, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## Georgia
```{r d52, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
 # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## Greater Bay
```{r d53, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## Greater CA
```{r d54, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## LA
```{r d55, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
 # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## Louisiana
```{r d56, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## New Jersey
```{r d57, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## Texas
```{r d58, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

## Virtual
```{r d59, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  # a. Did you live with anyone who was depressed, mentally ill, or suicidal?
  result<-questionr::freq(temp.dd$d5a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. Did you live with anyone who was depressed, mentally ill, or suicidal?")
# b. Did you live with anyone who was a problem drinker or alcoholic?
  result<-questionr::freq(temp.dd$d5b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. Did you live with anyone who was a problem drinker or alcoholic?")
# c. Did you live with anyone who used illegal street drugs or who abused prescription medications?  
  result<-questionr::freq(temp.dd$d5c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. Did you live with anyone who used illegal street drugs or who abused prescription medications?")
# d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility?  
  result<-questionr::freq(temp.dd$d5d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. Did you live with anyone who served time or was sentenced to serve time in a prison, jail, or other correctional facility? ")
# e. Were your parents separated or divorced? 
  result<-questionr::freq(temp.dd$d5e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. Were your parents separated or divorced? ")
# f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?
  result<-questionr::freq(temp.dd$d5f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. How often did your parents or adults in your home ever slap, hit, kick, punch or beat each other up?")  
# g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?
  result<-questionr::freq(temp.dd$d5g,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "g. How often did a parent or adult in your home ever hit, beat, kick, or physically hurt you in any way?") 
# h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?
  result<-questionr::freq(temp.dd$d5h,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "h. How often did a parent or adult in your home ever swear at you, insult you, or put you down?")
# i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?
  result<-questionr::freq(temp.dd$d5i,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "i. How often did anyone at least 5 years older than you or an adult, ever touch you sexually?")
# j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?
  result<-questionr::freq(temp.dd$d5j,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "j. How often did anyone at least 5 years older than you or an adult, try to make you touch them sexually?")
# k. How often did anyone at least 5 years older than you or an adult, force you to have sex?
  result<-questionr::freq(temp.dd$d5k,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "k. How often did anyone at least 5 years older than you or an adult, force you to have sex?")
rm(temp.dd) 
```

# D5 - ACES summary score{.tabset}
- Based on D5.
- ACES_Score=0;
  + If D5A=2 then ACES_Score+1;
  + If D5B=2 then ACES_Score+1;
  + If D5C=2 then ACES_Score+1;
  + If D5D=2 then ACES_Score+1;
  + If D5E=2 then ACES_Score+1;
  + If 1<D5F<4 then ACES_Score+1;
  + If 1<D5G<4 then ACES_Score+1;
  + If 1<D5H<4 then ACES_Score+1;
  + If 1<D5I<4 then ACES_Score+1;
  + If 1<D5J<4 then ACES_Score+1;
  + If 1<D5K<4 then ACES_Score+1;
  
```{r d5-create}
  temp.d$ACES_Score <- rep(0,nrow(temp.d))

  
  for (i in 1:nrow(temp.d)){
    for (j in 1:5){
      if(!is.na(temp.d[i,j])){
        if(temp.d[i,j]=="Yes"){
           temp.d[i,"ACES_Score"]<-temp.d[i,"ACES_Score"]+1
        }
      }
    }
  } 

 for (i in 1:nrow(temp.d)){
    for (j in 6:11){
      if(!is.na(temp.d[i,j])){
        if(temp.d[i,j]=="Once"||temp.d[i,j]=="More_than_once"){
           temp.d[i,"ACES_Score"]<-temp.d[i,"ACES_Score"]+1
        }
      }
    }
  } 

  new.d <- data.frame(new.d, temp.d$ACES_Score)
  names(new.d)[names(new.d) == 'temp.d.ACES_Score'] <- 'ACES_Score'
  rm(temp.d)
```
## All data
```{r D5-table, message=FALSE}  
  m<- data.frame(mean(new.d$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(new.d$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(new.d$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
```

## Detroit
```{r D5-table1, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Detroit"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```  

## Georgia
```{r D5-table2, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Georgia"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```
## Greater Bay
```{r D5-table3, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater Bay"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```
## Greater CA
```{r D5-table4, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater California"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```
## LA
```{r D5-table5, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Los Angeles"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```
## Louisiana
```{r D5-table6, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Louisiana"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```
## New Jersey
```{r D5-table7, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "New Jersey"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```
## Texas
```{r D5-table8, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Texas"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```
## Virtual
```{r D5-table9, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Virtual"), ]
  m<- data.frame(mean(temp.dd$ACES_Score))
  colnames(m)<-c("ACES_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$ACES_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$ACES_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "ACES_Score")
rm(temp.dd)
```


# E10 {.tabset}
- E10. Please mark all the treatments that you have received for your prostate cancer? Mark all that apply.

## All data
```{r E10: treatments}
# 1.No treatment
  e10_1 <- as.factor(d[,"e10_1"])
# Make "*" to NA
  e10_1[which(e10_1=="*")]<-"NA"
  levels(e10_1) <- list(Yes="1")
  e10_1 <- ordered(e10_1, c("Yes"))
  
  new.d <- data.frame(new.d, e10_1)
  new.d <- apply_labels(new.d, e10_1 = "No treatment")
  temp.d <- data.frame (new.d.1, e10_1)  
  
  result<-questionr::freq(temp.d$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  e10_2 <- as.factor(d[,"e10_2"])
  # Make "*" to NA
  e10_2[which(e10_2=="*")]<-"NA"
  levels(e10_2) <- list(Yes="1")
  e10_2 <- ordered(e10_2, c("Yes"))
  
  new.d <- data.frame(new.d, e10_2)
  new.d <- apply_labels(new.d, e10_2 = "Active surveillance")
  temp.d <- data.frame (temp.d, e10_2)  
  
  result<-questionr::freq(temp.d$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  e10_3 <- as.factor(d[,"e10_3"])
  # Make "*" to NA
  e10_3[which(e10_3=="*")]<-"NA"
  levels(e10_3) <- list(Yes="1")
  e10_3 <- ordered(e10_3, c("Yes"))
  
  new.d <- data.frame(new.d, e10_3)
  new.d <- apply_labels(new.d, e10_3 = "Prostatectomy")
  temp.d <- data.frame (temp.d, e10_3)  
  
  result<-questionr::freq(temp.d$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation 
  e10_4 <- as.factor(d[,"e10_4"])
  # Make "*" to NA
  e10_4[which(e10_4=="*")]<-"NA"
  levels(e10_4) <- list(Yes="1")
  e10_4 <- ordered(e10_4, c("Yes"))
  
  new.d <- data.frame(new.d, e10_4)
  new.d <- apply_labels(new.d, e10_4 = "Radiation")
  temp.d <- data.frame (temp.d, e10_4)  
  
  result<-questionr::freq(temp.d$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  e10_5 <- as.factor(d[,"e10_5"])
  # Make "*" to NA
  e10_5[which(e10_5=="*")]<-"NA"
  levels(e10_5) <- list(Yes="1")
  e10_5 <- ordered(e10_5, c("Yes"))
  
  new.d <- data.frame(new.d, e10_5)
  new.d <- apply_labels(new.d, e10_5 = "Hormonal treatments")
  temp.d <- data.frame (temp.d, e10_5)  
  
  result<-questionr::freq(temp.d$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  e10_6 <- as.factor(d[,"e10_6"])
  # Make "*" to NA
  e10_6[which(e10_6=="*")]<-"NA"
  levels(e10_6) <- list(Yes="1")
  e10_6 <- ordered(e10_6, c("Yes"))
  
  new.d <- data.frame(new.d, e10_6)
  new.d <- apply_labels(new.d, e10_6 = "Provenge/immunotherapy")
  temp.d <- data.frame (temp.d, e10_6)  
  
  result<-questionr::freq(temp.d$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
#  7. Chemotherapy
  e10_7 <- as.factor(d[,"e10_7"])
  # Make "*" to NA
  e10_7[which(e10_7=="*")]<-"NA"
  levels(e10_7) <- list(Yes="1")
  e10_7 <- ordered(e10_7, c("Yes"))
  
  new.d <- data.frame(new.d, e10_7)
  new.d <- apply_labels(new.d, e10_7 = "Chemotherapy")
  temp.d <- data.frame (temp.d, e10_7)  
  
  result<-questionr::freq(temp.d$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  e10_8 <- as.factor(d[,"e10_8"])
  # Make "*" to NA
  e10_8[which(e10_8=="*")]<-"NA"
  levels(e10_8) <- list(Yes="1")
  e10_8 <- ordered(e10_8, c("Yes"))
  
  new.d <- data.frame(new.d, e10_8)
  new.d <- apply_labels(new.d, e10_8 = "Other")
  temp.d <- data.frame (temp.d, e10_8)  
  
  result<-questionr::freq(temp.d$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")

```

## Detroit
```{r e101, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## Georgia
```{r e102, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## Greater Bay
```{r e103, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## Greater CA
```{r e104, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## LA
```{r e105, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## Louisiana
```{r e106, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## New Jersey
```{r e107, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## Texas
```{r e108, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

## Virtual
```{r e109, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
    # 1. No treatment
  result<-questionr::freq(temp.dd$e10_1,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "1. No treatment")
# 2. Active surveillance
  result<-questionr::freq(temp.dd$e10_2,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "2. Active surveillance")
# 3. Prostatectomy
  result<-questionr::freq(temp.dd$e10_3,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "3. Prostatectomy")
# 4. Radiation  
  result<-questionr::freq(temp.dd$e10_4,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "4. Radiation")
# 5. Hormonal treatments
  result<-questionr::freq(temp.dd$e10_5,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "5. Hormonal treatments")
# 6. Provenge/immunotherapy
  result<-questionr::freq(temp.dd$e10_6,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "6. Provenge/immunotherapy")  
# 7. Chemotherapy
  result<-questionr::freq(temp.dd$e10_7,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "7. Chemotherapy") 
# 8. Other
  result<-questionr::freq(temp.dd$e10_8,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "8. Other")
rm(temp.dd) 
```

# E10 - PCA_Treat {.tabset}
- Based on E10
- PCA_Treat=0;
  + If E10_3=1 then PCA_Treat=1; prostatectomy
  + If PCA_Treat=0 then do;	
    - If E10_4=1 then PCA_Treat=2; radiation
    - End;	
  + If PCA_Treat=0 then do;	
    - If E10_8=1 then PCA_Treat=3; other	
    - End;	
  + If PCA_Treat=0 then do;	
    - If E10_2=1 then PCA_Treat=4; active surveillance
    - End;	
  + If PCA_Treat=0 then do;	
    - If (E10_5=1 or E10_6=1 or E10_7=1) then PCA_Treat=5; Hormone, chemo, immunotherapy	
    - End;	
  + If PCA_Treat=0 then do;	
    - If E10_1=1 then PCA_Treat=6; No treatment
    - End;	

```{r e10-create}
  temp.d$PCA_Treat <- rep(0,nrow(temp.d))

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,1])&&temp.d[i,1]=="Yes"){
      temp.d[i,"PCA_Treat"]<-6
    }
  }

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,5])&&temp.d[i,5]=="Yes"){
      temp.d[i,"PCA_Treat"]<-5
    }
  }

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,6])&&temp.d[i,6]=="Yes"){
      temp.d[i,"PCA_Treat"]<-5
    }
  }

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,7])&&temp.d[i,7]=="Yes"){
      temp.d[i,"PCA_Treat"]<-5
    }
  }

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,2])&&temp.d[i,2]=="Yes"){
      temp.d[i,"PCA_Treat"]<-4
    }
  }
  
  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,8])&&temp.d[i,8]=="Yes"){
      temp.d[i,"PCA_Treat"]<-3
    }
  }

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,4])&&temp.d[i,4]=="Yes"){
      temp.d[i,"PCA_Treat"]<-2
    }
  }

  for (i in 1:nrow(temp.d)){
    if(!is.na(temp.d[i,3])&&temp.d[i,3]=="Yes"){
      temp.d[i,"PCA_Treat"]<-1
    }
  }

  PCA_Treat <- as.factor(temp.d[,"PCA_Treat"])
  levels(PCA_Treat) <- list(Prostatectomy="1",
                     Radiation="2",
                     Other_HIFU_cryotherapy_etc="3",
                     Active_surveillance="4",
                     Hormone_chemo_immunotherapy="5",
                     No_treatment="6")
  PCA_Treat <- ordered(PCA_Treat, c("Prostatectomy","Radiation","Other_HIFU_cryotherapy_etc","Active_surveillance","Hormone_chemo_immunotherapy","No_treatment"))
  
  new.d <- data.frame(new.d, PCA_Treat)
  new.d <- apply_labels(new.d, PCA_Treat = "PCA_Treat")

  #new.d <- data.frame(new.d, temp.d$PCA_Treat)
  #names(new.d)[names(new.d) == 'temp.d.PCA_Treat'] <- 'PCA_Treat'
  rm(temp.d)
```
## All data
```{r e10-table}  
  #m<- data.frame(mean(new.d$PCA_Treat))
  #colnames(m)<-c("PCA_Treat")
  #kable(m, format = "simple", align = 'l', caption = "Mean")
  result<-questionr::freq(new.d$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
```

## Georgia
```{r e10-table2}  
temp.dd <- new.d[which(new.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```
## Greater Bay
```{r e10-table3}  
temp.dd <- new.d[which(new.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```
## Greater CA
```{r e10-table4}  
temp.dd <- new.d[which(new.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```
## LA
```{r e10-table5}  
temp.dd <- new.d[which(new.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```
## Louisiana
```{r e10-table6}  
temp.dd <- new.d[which(new.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```
## New Jersey
```{r e10-table7}  
temp.dd <- new.d[which(new.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```
## Texas
```{r e10-table8}  
temp.dd <- new.d[which(new.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```
## Virtual
```{r e10-table9}  
temp.dd <- new.d[which(new.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$PCA_Treat,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "PCA_Treat")
rm(temp.dd)
```

# E11 {.tabset}
- E11. Your treatment decision: How true is each of the following statements for you?

## All data
```{r E11}
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  e11a <- as.factor(d[,"e11a"])
# Make "*" to NA
  e11a[which(e11a=="*")]<-"NA"
  levels(e11a) <- list(Not_at_all="1",
                     A_little_bit="2",
                     Somewhat="3",
                     Quite_a_bit="4",
                     Very_much="5")
  e11a <- ordered(e11a, c("Not_at_all","A_little_bit","Somewhat","Quite_a_bit","Very_much"))
  
  new.d <- data.frame(new.d, e11a)
  new.d <- apply_labels(new.d, e11a = "all necessary information of tx")
  temp.d <- data.frame (new.d.1, e11a)  
  
  result<-questionr::freq(temp.d$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when a treatment was chosen for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  e11b <- as.factor(d[,"e11b"])
# Make "*" to NA
  e11b[which(e11b=="*")]<-"NA"
  levels(e11b) <- list(Not_at_all="1",
                     A_little_bit="2",
                     Somewhat="3",
                     Quite_a_bit="4",
                     Very_much="5")
  e11b <- ordered(e11b, c("Not_at_all","A_little_bit","Somewhat","Quite_a_bit","Very_much"))
  
  new.d <- data.frame(new.d, e11b)
  new.d <- apply_labels(new.d, e11b = "the effects of tx")
  temp.d <- data.frame (temp.d, e11b)  
  
  result<-questionr::freq(temp.d$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  e11c <- as.factor(d[,"e11c"])
# Make "*" to NA
  e11c[which(e11c=="*")]<-"NA"
  levels(e11c) <- list(Not_at_all="1",
                     A_little_bit="2",
                     Somewhat="3",
                     Quite_a_bit="4",
                     Very_much="5")
  e11c <- ordered(e11c, c("Not_at_all","A_little_bit","Somewhat","Quite_a_bit","Very_much"))
  
  new.d <- data.frame(new.d, e11c)
  new.d <- apply_labels(new.d, e11c = "right questions to ask")
  temp.d <- data.frame (temp.d, e11c)  
  
  result<-questionr::freq(temp.d$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment
  e11d <- as.factor(d[,"e11d"])
# Make "*" to NA
  e11d[which(e11d=="*")]<-"NA"
  levels(e11d) <- list(Not_at_all="1",
                     A_little_bit="2",
                     Somewhat="3",
                     Quite_a_bit="4",
                     Very_much="5")
  e11d <- ordered(e11d, c("Not_at_all","A_little_bit","Somewhat","Quite_a_bit","Very_much"))
  
  new.d <- data.frame(new.d, e11d)
  new.d <- apply_labels(new.d, e11d = "enough time to decide")
  temp.d <- data.frame (temp.d, e11d)  
  
  result<-questionr::freq(temp.d$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment")
#e. I am satisfied with the choices I made in treating my prostate cancer
  e11e <- as.factor(d[,"e11e"])
# Make "*" to NA
  e11e[which(e11e=="*")]<-"NA"
  levels(e11e) <- list(Not_at_all="1",
                     A_little_bit="2",
                     Somewhat="3",
                     Quite_a_bit="4",
                     Very_much="5")
  e11e <- ordered(e11e, c("Not_at_all","A_little_bit","Somewhat","Quite_a_bit","Very_much"))
  
  new.d <- data.frame(new.d, e11e)
  new.d <- apply_labels(new.d, e11e = "satisfied with the choices")
  temp.d <- data.frame (temp.d, e11e)  
  
  result<-questionr::freq(temp.d$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  e11f <- as.factor(d[,"e11f"])
# Make "*" to NA
  e11f[which(e11f=="*")]<-"NA"
  levels(e11f) <- list(Not_at_all="1",
                     A_little_bit="2",
                     Somewhat="3",
                     Quite_a_bit="4",
                     Very_much="5")
  e11f <- ordered(e11f, c("Not_at_all","A_little_bit","Somewhat","Quite_a_bit","Very_much"))
  
  new.d <- data.frame(new.d, e11f)
  new.d <- apply_labels(new.d, e11f = "recommend the tx")
  temp.d <- data.frame (temp.d, e11f)  
  
  result<-questionr::freq(temp.d$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
```

## Detroit
```{r e111, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")  
rm(temp.dd) 
```

## Georgia
```{r e112, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

## Greater Bay
```{r e113, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

## Greater CA
```{r e114, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

## LA
```{r e115, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

## Louisiana
```{r e116, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

## New Jersey
```{r e117, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

## Texas
```{r e118, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

## Virtual
```{r e119, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
#a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer
  result<-questionr::freq(temp.dd$e11a,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "a. I had all the information I needed when  a  treatment  was  chosen  for my prostate cancer")
#b. My doctors told me the whole story about the effects of treatment
  result<-questionr::freq(temp.dd$e11b,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "b. My doctors told me the whole story about the effects of treatment")
#c. I knew the right questions to ask my doctor
  result<-questionr::freq(temp.dd$e11c,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "c. I knew the right questions to ask my doctor")
#d. I had enough time to make a decision about my treatment 
  result<-questionr::freq(temp.dd$e11d,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "d. I had enough time to make a decision about my treatment ")
#e. I am satisfied with the choices I made in treating my prostate cancer
  result<-questionr::freq(temp.dd$e11e,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "e. I am satisfied with the choices I made in treating my prostate cancer")
#f. I would recommend the treatment I had to a close relative or friend
  result<-questionr::freq(temp.dd$e11f,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "f. I would recommend the treatment I had to a close relative or friend")
rm(temp.dd) 
```

# E11 - Treatment satisfaction summary score{.tabset}

```{r e11-create}
  temp.d$TrtSat_Score <- rep(0,nrow(temp.d))

  for (i in 1:nrow(temp.d)){
    for (j in 1:6){
      if(!is.na(temp.d[i,j])){
        if(temp.d[i,j]=="Quite_a_bit"||temp.d[i,j]=="Very_much"){
           temp.d[i,"TrtSat_Score"]<-temp.d[i,"TrtSat_Score"]+1
        }
      }
    }
  } 

  new.d <- data.frame(new.d, temp.d$TrtSat_Score)
  names(new.d)[names(new.d) == 'temp.d.TrtSat_Score'] <- 'TrtSat_Score'
  rm(temp.d)
```

## All data
```{r e11-table, message=FALSE}  
  m<- data.frame(mean(new.d$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(new.d$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(new.d$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
```

## Detroit
```{r e11-table1, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Detroit"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```  

## Georgia
```{r e11-table2, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Georgia"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```
## Greater Bay
```{r e11-table3, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater Bay"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```
## Greater CA
```{r e11-table4, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Greater California"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```
## LA
```{r e11-table5, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Los Angeles"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```
## Louisiana
```{r e11-table6, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Louisiana"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```
## New Jersey
```{r e11-table7, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "New Jersey"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```
## Texas
```{r e11-table8, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Texas"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```
## Virtual
```{r e11-table9, message=FALSE}  
temp.dd <- new.d[which(new.d$locationname == "Virtual"), ]
  m<- data.frame(mean(temp.dd$TrtSat_Score))
  colnames(m)<-c("TrtSat_Score")
  kable(m, format = "simple", align = 'l', caption = "Mean")
  summarytools::view(dfSummary(temp.dd$TrtSat_Score, style = 'grid',
                               max.distinct.values = 100, plain.ascii =   FALSE, valid.col = FALSE, headings = FALSE), method = "render")
  result<-questionr::freq(temp.dd$TrtSat_Score,cum=T,total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "TrtSat_Score")
rm(temp.dd)
```





# E14 {.tabset}
- E14. Since diagnosis or treatment, have you ever been told that your PSA was rising?

## All data
```{r E14}
  e14 <- as.factor(d[,"e14"])
# Make "*" to NA
  e14[which(e14=="*")]<-"NA"
  levels(e14) <- list(No="1",
                     Yes="2",
                     Dont_know_not_sure="88")
  e14 <- ordered(e14, c( "No","Yes","Dont_know_not_sure"))
  
  new.d <- data.frame(new.d, e14)
  new.d <- apply_labels(new.d, e14 = "PSA rising")
  temp.d <- data.frame (new.d, e14)  
  
  result<-questionr::freq(temp.d$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r E141, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r E142, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r E143, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r E144, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r E145, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r E146, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r E147, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r E148, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r E149, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$e14,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# E15 {.tabset}
- E15. Since you were diagnosed, did your doctor ever tell you that your prostate cancer came back (recurred) or progressed (got worse)?

## All data
```{r E15}
  e15 <- as.factor(d[,"e15"])
# Make "*" to NA
  e15[which(e15=="*")]<-"NA"
  levels(e15) <- list(No="1",
                     Yes="2",
                     Dont_know_not_sure="88",
                     Scantron_Error="*")
  e15 <- ordered(e15, c( "No","Yes","Dont_know_not_sure","Scantron_Error"))
  
  new.d <- data.frame(new.d, e15)
  new.d <- apply_labels(new.d, e15 = "recurred or worse")
  temp.d <- data.frame (new.d, e15)  
  
  result<-questionr::freq(temp.d$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r e151, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r e152, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r e153, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r e154, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r e155, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r e156, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r e157, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r e158, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r e159, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$e15,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# G1 {.tabset}
- G1. What is your current marital status?

## All data
```{r g1}
  g1 <- as.factor(d[,"g1"])
# Make "*" to NA
  g1[which(g1=="*")]<-"NA"

  levels(g1) <- list(Married_partner="1",
                     Separated="2",
                     Divorced="3",
                     Widowed="4",
                     Never_married="5")
  g1 <- ordered(g1, c("Married_partner","Separated","Divorced","Widowed","Never_married"))
  
  new.d <- data.frame(new.d, g1)
  new.d <- apply_labels(new.d, g1 = "current marital status")
  temp.d <- data.frame (new.d, g1)  
  
  result<-questionr::freq(temp.d$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r g11, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r g12, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r g13, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r g14, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r g15, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r g16, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r g17, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r g18, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r g19, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$g1,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# G3 {.tabset}
- G3. How do you identify yourself?

## All data
```{r g3}
  g3 <- as.factor(d[,"g3"])
# Make "*" to NA
  g3[which(g3=="*")]<-"NA"
  levels(g3) <- list(Straight_heterosexual="1",
                     Bisexual="2",
                     Gay_homosexual="3",
                     Other="4",
                     Prefer_not_answer="99")
  g3 <- ordered(g3, c("Straight_heterosexual","Bisexual","Gay_homosexual","Other","Prefer_not_answer"))
  
  new.d <- data.frame(new.d, g3)
  new.d <- apply_labels(new.d, g3 = "self-identify")
  temp.d <- data.frame (new.d, g3)  
  
  result<-questionr::freq(temp.d$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r g31, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r g32, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r g33, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r g34, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r g35, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r g36, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r g37, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r g38, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r g39, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$g3,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# G4A {.tabset}
- G4A. What is the HIGHEST level of education you have completed?

## All data
```{r g4a}
  g4a <- as.factor(d[,"g4a"])
# Make "*" to NA
  g4a[which(g4a=="**")]<-"NA"
  levels(g4a) <- list(Grade_school_or_less="1",
                     Some_high_school="2",
                     High_School_grad_GED="3",
                     Vocational_school="4",
                     Some_college="5",
                     Associate_degree="6",
                     College_grad="7",
                     Some_grad_education="8",
                     Grad_degree="9")
  g4a <- ordered(g4a, c("Grade_school_or_less","Some_high_school","High_School_grad_GED","Vocational_school",
                        "Some_college","Associate_degree","College_grad","Some_grad_education","Grad_degree"))
  
  new.d <- data.frame(new.d, g4a)
  new.d <- apply_labels(new.d, g4a = "education")
  temp.d <- data.frame (new.d, g4a)  
  
  result<-questionr::freq(temp.d$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r g4a1, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r g4a2, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r g4a3, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r g4a4, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r g4a5, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r g4a6, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r g4a7, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r g4a8, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r g4a9, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$g4a, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# G5 {.tabset}
- G5. Which one of the following best describes what you currently do?

## All data
```{r g5}
  g5 <- as.factor(d[,"g5"])
# Make "*" to NA
  g5[which(g5=="*")]<-"NA"
  levels(g5) <- list(full_time="1",
                     part_time="2",
                     Look_for_work_unemployed="3",
                     Retired="4",
                     Disability_permanently="5",
                     Disability_temporarily="6",
                     Volunteer="7",
                     Other="8")
  g5 <- ordered(g5, c("full_time","part_time","Look_for_work_unemployed","Retired",
                      "Disability_permanently","Disability_temporarily","Volunteer","Other"))
  
  new.d <- data.frame(new.d, g5)
  new.d <- apply_labels(new.d, g5 = "occupation")
  temp.d <- data.frame (new.d, g5)  
  
  result<-questionr::freq(temp.d$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r g51, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r g52, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r g53, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r g54, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r g55, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r g56, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r g57, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r g58, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r g59, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$g5,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# G7 {.tabset}
- G7. What is your best estimate of your TOTAL FAMILY INCOME from all sources, before taxes, in the last calendar year? “Total family income” refers to your income PLUS the income of all family members living in this household (including cohabiting partners, and armed forces members living at home). This includes money from pay checks, government benefit programs, child support, social security, retirement funds, unemployment benefits, and
disability.
  + 1=Less than $15,000 
  + 2=$15,000 to $35,999
  + 3=$36,000 to $45,999
  + 4=$46,000 to $65,999
  + 5=$66,000 to $99,999
  + 6=$100,000 to $149,999
  + 7=$150,000 to $199,999
  + 8= $200,000 or more

## All data
```{r g7}
  g7 <- as.factor(d[,"g7"])
# Make "*" to NA
  g7[which(g7=="*")]<-"NA"
  levels(g7) <- list(Less_than_15000="1",
                     Range_15000_35999="2",
                     Range_36000_45999="3",
                     Range_46000_65999="4",
                     Range_66000_99999="5",
                     Range_100000_149999="6",
                     Range_150000_199999="7",
                     more_2000000="8")
  g7 <- ordered(g7, c("Less_than_15000","Range_15000_35999","Range_36000_45999","Range_46000_65999",
                      "Range_66000_99999","Range_100000_149999","Range_150000_199999","more_2000000"))
  
  new.d <- data.frame(new.d, g7)
  new.d <- apply_labels(new.d, g7 = "family income")
  temp.d <- data.frame (new.d, g7)  
  
  result<-questionr::freq(temp.d$g7, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r g71, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r g72, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r g73, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r g74, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r g75, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r g76, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r g77, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r g78, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r g79, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$g7, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# G10 {.tabset}
- G10. Is the home you live in:
  + 1=Owned or being bought by you (or someone in the household) 
  + 2=Rented for money
  + 3=Other

## All data
```{r g10}
  g10 <- as.factor(d[,"g10"])
# Make "*" to NA
  g10[which(g10=="*")]<-"NA"
  levels(g10) <- list(Owned_by_you="1",
                     Rented="2",
                     Other="3")
  g10 <- ordered(g10, c("Owned_by_you","Rented","Other"))
  
  new.d <- data.frame(new.d, g10)
  new.d <- apply_labels(new.d, g10 = "Owned or rented")
  temp.d <- data.frame (new.d, g10)  
  
  result<-questionr::freq(temp.d$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r g101, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r g102, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r g103, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r g104, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r g105, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$g10,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r g106, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r g107, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r g108, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r g109, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$g10, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```


# G11 {.tabset}
- G11. If you lost all your current source(s) of household income (your paycheck, public assistance, or other forms of income), how long could you continue to live at
your current address and standard of living?
  + 1=Less than 1 month 
  + 2=1 to 2 months
  + 3=3 to 6 months 
  + 4=More than 6 months

## All data
```{r g11all}
  g11 <- as.factor(d[,"g11"])
# Make "*" to NA
  g11[which(g11=="*")]<-"NA"
  levels(g11) <- list(Less_than_1_month="1",
                     Range_1_2="2",
                     Range_3_6="3",
                     More_than_6_months="4")
  g11 <- ordered(g11, c("Less_than_1_month","Range_1_2","Range_3_6","More_than_6_months"))
  
  new.d <- data.frame(new.d, g11)
  new.d <- apply_labels(new.d, g11 = "Owned or rented")
  temp.d <- data.frame (new.d, g11)  
  
  result<-questionr::freq(temp.d$g11, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
```

## Detroit
```{r g111, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Detroit"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Georgia
```{r g112, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Georgia"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater Bay
```{r g113, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater Bay"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Greater CA
```{r g114, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Greater California"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## LA
```{r g115, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Los Angeles"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Louisiana
```{r g116, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Louisiana"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## New Jersey
```{r g117, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "New Jersey"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Texas
```{r g118, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Texas"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

## Virtual
```{r g119, echo=FALSE}
temp.dd <- temp.d[which(temp.d$locationname == "Virtual"), ]
  result<-questionr::freq(temp.dd$g11, cum = TRUE,total = TRUE)
  kable(result, format = "simple", align = 'l')
rm(temp.dd) 
```

# Age Response {.tabset}
- AgeResponse=(currentyr-2000)+(2000-birthyr);

```{r age-create, message=FALSE}
cur_date<- d[,"g12"]
date = strsplit(cur_date, "/")
cur_yr<-vector(mode="character",length=0)
for (i in 1:length(date)){
  cur_yr<-c(cur_yr, date[[i]][3])
}
result<-questionr::freq(cur_yr, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Current Year")

result<-questionr::freq(d$a4year, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Birth Year")
#bir_date<- d[,"a4year"]
#AgeResponse<-cur_yr-bir_date
```

- Clean both year variables based on the year of 2000 and the year of 2021


- Current year
  + if cur_yr > 2021 or cur_yr < 2000, then NA

- Birth year
  + if bir_yr > 2000 or bir_yr < 1900, then NA
```{r age-clean, message=FALSE, warning=FALSE}
cur_yr<-as.numeric(cur_yr)
bir_yr<- d[,"a4year"]
bir_yr<-as.numeric(bir_yr)
#Clean current year based on the year of 2000
for (i in 1:length(cur_yr)){
  if (!is.na(cur_yr[i])){
    if (cur_yr[i]>2021 || cur_yr[i]<2000){
      cur_yr[i]<-NA
    }
  }
}

for (i in 1:length(bir_yr)){
  if (!is.na(bir_yr[i])){
    if (bir_yr[i]<1900 ||bir_yr[i]>2000){
      bir_yr[i]<-NA
    }
  }
}

result<-questionr::freq(cur_yr, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Current Year")

result<-questionr::freq(bir_yr, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Birth Year")
```

# Age Response Group{.tabset}

```{r age group}
#AgeResponse=cur_yr-bir_yr
AgeResponse<-vector(mode="numeric",length=0)
for (i in 1:length(cur_yr)){
  AgeResponse[i]=cur_yr[i]-bir_yr[i]
}

result<-questionr::freq(AgeResponse, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Response")

 # Categorize
AgeGroup<-vector(mode="character",length=0)

for (i in 1:length(AgeResponse)){
  if (!is.na(AgeResponse[i])){
    if (AgeResponse[i]<40){
      AgeGroup[i]=1
    }
    else if (AgeResponse[i]<50){
      AgeGroup[i]=2
    }
    else if (AgeResponse[i]<60){
      AgeGroup[i]=3
    }
    else if (AgeResponse[i]<70){
      AgeGroup[i]=4
    }
    else if (AgeResponse[i]<75){
      AgeGroup[i]=5
    }
    else {
      AgeGroup[i]=6
    }
  }
}
```

## All data
```{r age group table}
AgeGroup<-as.factor(AgeGroup)
levels(AgeGroup) <- list(Younger_than_40="1",
                     Age_40_49="2",
                     Age_50_59="3",
                     Age_60_69="4",
                     Age_70_74="5",
                     Older_than_75="6")
 result<-questionr::freq(AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group") 
  new.d<-data.frame(new.d, AgeGroup)

```

## Detroit
```{r age group-table1}  
temp.dd <- new.d[which(new.d$locationname == "Detroit"), ]
 result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group") 
rm(temp.dd)
```  

## Georgia
```{r age group-table2}  
temp.dd <- new.d[which(new.d$locationname == "Georgia"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```
## Greater Bay
```{r age group-table3}  
temp.dd <- new.d[which(new.d$locationname == "Greater Bay"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```
## Greater CA
```{r age group-table4}  
temp.dd <- new.d[which(new.d$locationname == "Greater California"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```
## LA
```{r age group-table5}  
temp.dd <- new.d[which(new.d$locationname == "Los Angeles"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```
## Louisiana
```{r age group-table6}  
temp.dd <- new.d[which(new.d$locationname == "Louisiana"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```
## New Jersey
```{r age group-table7}  
temp.dd <- new.d[which(new.d$locationname == "New Jersey"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```
## Texas
```{r age group-table8}  
temp.dd <- new.d[which(new.d$locationname == "Texas"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```
## Virtual
```{r age group-table9}  
temp.dd <- new.d[which(new.d$locationname == "Virtual"), ]
result<-questionr::freq(temp.dd$AgeGroup, cum = TRUE, total = TRUE)
  kable(result, format = "simple", align = 'l', caption = "Age Group")
rm(temp.dd)
```